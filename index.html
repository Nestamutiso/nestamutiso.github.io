<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MindCheck Pro</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #7d5fff; --bg: #fdfbff; --text: #1e272e;
            --card: #ffffff; --bot: #7d5fff; --user: #efedff;
            --danger: #ff4757; --success: #2ed573;
        }
        body.dark-mode {
            --bg: #121212; --text: #e0e0e0; --card: #1e1e1e;
            --user: #2d2d2d; --bot: #a29bfe;
        }

        /* Essential Mobile Fixes */
        * { box-sizing: border-box; max-width: 100%; -webkit-tap-highlight-color: transparent; }
        
        body { 
            margin: 0; padding: 0; font-family: 'Outfit', sans-serif; 
            background: var(--bg); color: var(--text); 
            height: 100vh; width: 100vw; overflow: hidden; 
        }

        /* --- Login Screen --- */
        #auth-screen {
            position: fixed; inset: 0; background: var(--primary); z-index: 10000;
            display: flex; align-items: center; justify-content: center; padding: 20px;
        }
        .auth-card { background: white; padding: 35px; border-radius: 30px; width: 100%; max-width: 350px; text-align: center; }
        input[type="text"] { width: 100%; padding: 15px; margin: 15px 0; border-radius: 12px; border: 1px solid #ddd; font-size: 16px; outline: none; }
        .btn-main { width: 100%; padding: 15px; background: var(--primary); color: white; border: none; border-radius: 12px; font-weight: 700; cursor: pointer; }

        /* --- App Structure --- */
        .app-shell { height: 100vh; display: none; flex-direction: column; }
        .view { display: none; flex: 1; overflow-y: auto; padding: 20px 20px 100px; width: 100%; }
        .view.active { display: flex; flex-direction: column; }

        header { padding: 20px 0; flex-shrink: 0; }
        .app-card { background: var(--card); border-radius: 25px; padding: 20px; margin-bottom: 20px; box-shadow: 0 8px 25px rgba(0,0,0,0.05); }

        /* --- Conversational AI Chat --- */
        #chat-log { flex: 1; display: flex; flex-direction: column; gap: 12px; margin-bottom: 15px; }
        .bubble { max-width: 85%; padding: 14px 18px; border-radius: 22px; font-size: 15px; line-height: 1.5; }
        .bot { background: var(--bot); color: white; align-self: flex-start; border-bottom-left-radius: 4px; }
        .user { background: var(--user); color: var(--text); align-self: flex-end; border-bottom-right-radius: 4px; }

        .input-bar { background: var(--card); padding: 10px; border-radius: 30px; display: flex; align-items: center; gap: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        #user-input { flex: 1; border: none; background: transparent; color: var(--text); padding: 10px; font-size: 16px; outline: none; }

        /* --- Insights --- */
        .mood-row { display: grid; grid-template-columns: repeat(7, 1fr); gap: 5px; margin-top: 15px; }
        .day-dot { height: 35px; border-radius: 10px; background: #eee; display: flex; align-items: center; justify-content: center; font-size: 10px; color: #999; }
        .day-dot.high { background: var(--success); color: white; }
        .day-dot.low { background: var(--primary); color: white; }

        /* --- Navigation --- */
        nav {
            position: fixed; bottom: 0; left: 0; right: 0; height: 85px;
            background: #1e272e; display: flex; justify-content: space-around; align-items: center; padding-bottom: 10px;
        }
        .nav-link { background: none; border: none; color: #808e9b; font-size: 24px; cursor: pointer; transition: 0.3s; }
        .nav-link.active { color: white; transform: translateY(-5px); }
    </style>
</head>
<body>

    <div id="auth-screen">
        <div class="auth-card">
            <h1>üåø</h1>
            <h2 style="color:#333">MindCheck</h2>
            <p style="color:#666">Who's checking in today?</p>
            <input type="text" id="login-name" placeholder="Your Name">
            <button class="btn-main" onclick="app.login()">Launch App</button>
        </div>
    </div>

    <div class="app-shell" id="app-shell">
        
        <main id="home" class="view active">
            <header><h1 id="user-greet" style="margin:0">Hello</h1></header>
            <div id="chat-log"></div>
            <div class="input-bar">
                <input type="text" id="user-input" placeholder="What's on your mind?" autocomplete="off">
                <button onclick="app.send()" style="background:var(--primary); color:white; border:none; width:45px; height:45px; border-radius:50%; font-size:20px; cursor:pointer;">‚Üë</button>
            </div>
        </main>

        <main id="insights" class="view">
            <header><h1>Insights</h1></header>
            <div class="app-card">
                <h3>Vibe Check</h3>
                <p id="vibe-text" style="color:#888; font-size: 14px;">Share more thoughts to see your summary.</p>
                <button class="btn-main" style="padding:10px;" onclick="app.refreshVibe()">Update Summary</button>
            </div>
            <div class="app-card">
                <h3>Mood History</h3>
                <div class="mood-row" id="mood-calendar"></div>
            </div>
            <div id="crisis-card" style="display:none; background:#fff5f5; border: 2px solid var(--danger); padding:20px; border-radius:25px;">
                <h3 style="color:var(--danger); margin:0;">Emergency</h3>
                <p style="font-size:13px; color:#333;">Help is available 24/7 in Kenya.</p>
                <button onclick="window.open('tel:0722178177')" class="btn-main" style="background:var(--danger)">Call 0722 178 177</button>
            </div>
        </main>

        <main id="settings" class="view">
            <header><h1>Settings</h1></header>
            <div class="app-card">
                <p>Logged in as: <b id="display-user"></b></p>
                <button class="btn-main" style="margin-bottom:10px;" onclick="app.dark()">Toggle Dark Mode</button>
                <button class="btn-main" style="background:#eee; color:#333" onclick="location.reload()">Logout</button>
            </div>
        </main>

        <nav>
            <button class="nav-link active" onclick="app.tab('home', this)">üè†</button>
            <button class="nav-link" onclick="app.tab('insights', this)">üìä</button>
            <button class="nav-link" onclick="tab('settings', this)">‚öôÔ∏è</button>
        </nav>
    </div>

    <script>
        const app = {
            user: "",
            history: [],
            score: 0,
            
            login: function() {
                const name = document.getElementById('login-name').value.trim();
                if(!name) return alert("Enter name");
                this.user = name;
                document.getElementById('auth-screen').style.display = 'none';
                document.getElementById('app-shell').style.display = 'flex';
                document.getElementById('user-greet').innerText = "Hi, " + name;
                document.getElementById('display-user').innerText = name;
                this.addBubble(`Hey ${name}. I'm your AI thought partner. How are you really feeling? I'm listening.`, 'bot');
                this.renderCalendar();
            },

            tab: function(id, btn) {
                document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
                document.querySelectorAll('.nav-link').forEach(n => n.classList.remove('active'));
                document.getElementById(id).classList.add('active');
                btn.classList.add('active');
            },

            send: function() {
                const input = document.getElementById('user-input');
                const text = input.value.trim();
                if(!text) return;
                this.addBubble(text, 'user');
                this.history.push(text.toLowerCase());
                input.value = "";

                // Crisis Check
                if(text.toLowerCase().match(/kill|suicide|die|hurt myself|danger/)) {
                    document.getElementById('crisis-card').style.display = 'block';
                }

                // AI Reasoning
                setTimeout(() => {
                    let response = this.reason(text.toLowerCase());
                    this.addBubble(response, 'bot');
                }, 800);
            },

            addBubble: function(txt, side) {
                const log = document.getElementById('chat-log');
                const div = document.createElement('div');
                div.className = `bubble ${side}`;
                div.innerText = txt;
                log.appendChild(div);
                log.scrollTop = log.scrollHeight;
            },

            reason: function(input) {
                const sadPool = ["I hear the weight in that. It's okay to sit with that feeling‚Äîyou don't have to fix it for me. What's the toughest part today?", "That sounds incredibly draining. I'm right here with you.", "I can feel how much you're carrying. Thank you for being honest with me."];
                const joyPool = ["I love that for you! ‚ú® What was the best part of that moment?", "That's a huge win! You deserve every bit of that light.", "Wonderful! What's one thing you're grateful for right now?"];
                const fallback = ["I see. How are you honestly navigating that in your head?", "Has this been on your mind for a while?", "If you had to describe the vibe of today in one word, what would it be?"];

                if(input.match(/sad|hurt|bad|fail|tired|lonely|cry|heavy/)) { this.score--; return sadPool[Math.floor(Math.random()*3)]; }
                if(input.match(/happy|good|great|won|win|love|amazing/)) { this.score++; return joyPool[Math.floor(Math.random()*3)]; }
                
                return fallback[Math.floor(Math.random()*3)];
            },

            refreshVibe: function() {
                const vibe = document.getElementById('vibe-text');
                if(this.score < 0) vibe.innerText = "Current Vibe: Reflective & Tender. You've been carrying a lot. Be kind to yourself.";
                else if(this.score > 0) vibe.innerText = "Current Vibe: Radiant & Growing! You're focusing on wins.";
                else vibe.innerText = "Current Vibe: Balanced. You're staying present.";
            },

            renderCalendar: function() {
                const cal = document.getElementById('mood-calendar');
                cal.innerHTML = "";
                for(let i=1; i<=7; i++) {
                    const d = document.createElement('div');
                    d.className = 'day-dot';
                    d.innerText = "D" + i;
                    cal.appendChild(d);
                }
            },

            dark: function() { document.body.classList.toggle('dark-mode'); }
        };

        // Fix Navigation
        function tab(id, btn) { app.tab(id, btn); }

        document.getElementById('user-input').addEventListener('keypress', (e) => {
            if(e.key === 'Enter') app.send();
        });
    </script>
</body>
</html>
