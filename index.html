<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>MindCheck | Ultimate Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #7d5fff;
            --bg: #fdfbff;
            --text: #1e272e;
            --card: #ffffff;
            --user-bubble: #efedff;
            --bot-bubble: #7d5fff;
            --subtle: #a4b0be;
        }

        body.dark-mode {
            --bg: #121212;
            --text: #e0e0e0;
            --card: #1e1e1e;
            --user-bubble: #2d2d2d;
            --bot-bubble: #a29bfe;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

        body {
            font-family: 'Outfit', sans-serif;
            background-color: var(--bg);
            margin: 0; color: var(--text);
            height: 100vh; overflow: hidden;
            transition: background 0.4s ease;
        }

        /* --- Auth/Login Screen --- */
        #auth-screen {
            position: fixed; inset: 0; background: var(--primary); z-index: 10000;
            display: flex; align-items: center; justify-content: center; padding: 20px;
        }
        .auth-card {
            background: white; padding: 40px 30px; border-radius: 35px;
            width: 100%; max-width: 380px; text-align: center;
            box-shadow: 0 20px 50px rgba(0,0,0,0.2);
        }
        .auth-card input {
            width: 100%; padding: 15px; margin: 15px 0; border-radius: 15px;
            border: 2px solid #eee; outline: none; font-size: 16px;
        }
        .auth-btn {
            width: 100%; padding: 15px; background: var(--primary);
            color: white; border: none; border-radius: 15px;
            font-weight: 700; cursor: pointer;
        }

        /* --- App Structure --- */
        .app-shell { height: 100vh; display: none; flex-direction: column; }
        header { padding: 40px 25px 10px; flex-shrink: 0; }
        .view { display: none; flex: 1; overflow-y: auto; padding: 10px 20px 120px; }
        .view.active { display: flex; flex-direction: column; animation: slideUp 0.4s ease; }

        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } }

        /* --- Chat Interface --- */
        #chat-log {
            flex: 1; overflow-y: auto; display: flex; flex-direction: column;
            gap: 15px; padding: 10px 0;
        }
        .bubble { max-width: 85%; padding: 14px 18px; border-radius: 22px; font-size: 15px; line-height: 1.5; }
        .bot { background: var(--bot-bubble); color: white; align-self: flex-start; border-bottom-left-radius: 4px; }
        .user { background: var(--user-bubble); color: var(--text); align-self: flex-end; border-bottom-right-radius: 4px; }

        .input-container {
            background: var(--card); padding: 12px; border-radius: 25px;
            display: flex; align-items: center; gap: 10px; 
            box-shadow: 0 5px 20px rgba(0,0,0,0.05); margin-top: 10px;
        }
        #user-input { flex: 1; border: none; background: transparent; color: var(--text); font-size: 16px; outline: none; }

        /* --- Navigation --- */
        nav {
            position: fixed; bottom: 25px; left: 20px; right: 20px;
            background: #1e272e; height: 75px; border-radius: 35px;
            display: flex; justify-content: space-around; align-items: center;
        }
        .nav-link { background: none; border: none; color: #808e9b; font-size: 24px; cursor: pointer; transition: 0.3s; }
        .nav-link.active { color: white; transform: translateY(-5px); }

        .settings-card { background: var(--card); border-radius: 25px; padding: 25px; margin-bottom: 20px; }
        .s-row { display: flex; justify-content: space-between; align-items: center; padding: 15px 0; border-bottom: 1px solid rgba(0,0,0,0.05); }
    </style>
</head>
<body>

    <div id="auth-screen">
        <div class="auth-card">
            <h1>üåø</h1>
            <h2>MindCheck</h2>
            <p>Enter your name to start our conversation.</p>
            <input type="text" id="username" placeholder="Your Name">
            <button class="auth-btn" onclick="login()">Enter</button>
        </div>
    </div>

    <div class="app-shell" id="app-shell">
        <main id="home" class="view active">
            <header>
                <span id="date-label" style="font-size: 11px; color: var(--subtle); font-weight: 700;"></span>
                <h1 id="greeting" style="margin: 5px 0;">Hello.</h1>
            </header>
            <div id="chat-log"></div>
            <div class="input-container">
                <input type="text" id="user-input" placeholder="What's on your mind?" autocomplete="off">
                <button onclick="sendMsg()" style="background:var(--primary); color:white; border:none; width:45px; height:45px; border-radius:50%; cursor:pointer;">‚Üë</button>
            </div>
        </main>

        <main id="settings" class="view">
            <header><h1>Profile & Insights</h1></header>
            <div class="settings-card">
                <h3>Vibe Check</h3>
                <p id="vibe-summary" style="color:var(--subtle); font-size: 14px;">Log a message to see your vibe summary.</p>
                <button onclick="runVibeCheck()" style="width:100%; padding:12px; border:none; border-radius:12px; background:var(--primary); color:white; font-weight:700;">Refresh Vibe</button>
            </div>
            <div class="settings-card">
                <div class="s-row"><span>User</span><b id="user-disp"></b></div>
                <div class="s-row"><span>Dark Mode</span><button onclick="toggleDark()" style="border:none; padding:5px 12px; border-radius:8px;">Toggle</button></div>
                <div class="s-row" onclick="logout()" style="color:red; cursor:pointer; border:none;"><span>Logout</span></div>
            </div>
        </main>

        <nav>
            <button class="nav-link active" onclick="gotoTab('home', this)">üè†</button>
            <button class="nav-link" onclick="gotoTab('settings', this)">üìä</button>
        </nav>
    </div>

    <script>
        let userName = "";
        let chatMemory = { lastTopic: "", moodScore: 0 }; // Positive score = happy, Negative = sad

        function login() {
            const input = document.getElementById('username').value;
            if(!input.trim()) return;
            userName = input;
            localStorage.setItem('mindcheck_v5_user', userName);
            document.getElementById('auth-screen').style.display = 'none';
            document.getElementById('app-shell').style.display = 'flex';
            document.getElementById('user-disp').innerText = userName;
            startApp();
        }

        function logout() { localStorage.clear(); location.reload(); }

        function startApp() {
            const hr = new Date().getHours();
            const greet = hr < 12 ? "Good morning" : hr < 18 ? "Good afternoon" : "Good evening";
            document.getElementById('greeting').innerText = `${greet}, ${userName}`;
            document.getElementById('date-label').innerText = new Date().toLocaleDateString('en-US', {weekday:'long', month:'short', day:'numeric'});
            addBubble(`Hi ${userName}. I've been waiting to hear from you. How are you feeling today?`, 'bot');
        }

        function gotoTab(id, btn) {
            document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
            document.querySelectorAll('.nav-link').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            btn.classList.add('active');
        }

        function sendMsg() {
            const input = document.getElementById('user-input');
            const text = input.value.trim();
            if(!text) return;
            addBubble(text, 'user');
            input.value = "";
            setTimeout(() => {
                const reply = reason(text.toLowerCase());
                addBubble(reply, 'bot');
            }, 800);
        }

        function addBubble(msg, side) {
            const log = document.getElementById('chat-log');
            const div = document.createElement('div');
            div.className = `bubble ${side}`;
            div.innerText = msg;
            log.appendChild(div);
            log.scrollTop = log.scrollHeight;
        }

        function reason(input) {
            if(input.match(/sad|hurt|lonely|tired|fail|hard|difficult|awful|bad|cry/)) {
                chatMemory.moodScore -= 1;
                chatMemory.lastTopic = "some heavy emotions";
                return `I hear the weight in that. It's okay to not be okay, ${userName}. I'm here to sit with you in this. What's the toughest part of it right now?`;
            }
            if(input.match(/happy|good|great|amazing|love|win|smile|won/)) {
                chatMemory.moodScore += 1;
                chatMemory.lastTopic = "a positive win";
                return `That's wonderful! ‚ú® It makes me genuinely happy to see you in this space. Hold onto that light. What was the best part of that moment?`;
            }
            if(input.includes("remember") || input.includes("last time")) {
                return chatMemory.lastTopic ? `Of course. We were talking about ${chatMemory.lastTopic}. How has that been since?` : "I'm listening closely to our talk right now!";
            }
            return "I'm following you. Tell me more‚ÄîI want to understand your perspective better.";
        }

        function runVibeCheck() {
            const summary = document.getElementById('vibe-summary');
            if(chatMemory.moodScore < 0) summary.innerText = "Current Vibe: Reflective & Tender. You've been navigating some heavy thoughts. Remember to be kind to yourself.";
            else if(chatMemory.moodScore > 0) summary.innerText = "Current Vibe: Bright & Growing. You're focusing on the wins today! Keep protecting that peace.";
            else summary.innerText = "Current Vibe: Balanced. You're checking in and staying present. That's a win in itself.";
        }

        function toggleDark() { document.body.classList.toggle('dark-mode'); }

        window.onload = () => {
            const saved = localStorage.getItem('mindcheck_v5_user');
            if(saved) { document.getElementById('username').value = saved; login(); }
        }

        document.getElementById('user-input').addEventListener('keypress', e => { if(e.key === 'Enter') sendMsg(); });
    </script>
</body>
</html>
